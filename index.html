<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <script src="jquery-3.5.1.min.js"></script>
  <!--
  <script type="text/javascript" src="main.js"></script>
  -->
  <script src="nbt.js"></script>
  <title>mcstructure editor</title>
  <style>
  body {
  font-family: "Helvetica";
  }
  .textarea {
  width: 100%;
  height:30%;
  }
  </style>
  
</head>

<body>
<h1>mcstructure editor</h1>
  <form id="form">
  <input type="file" id="file" />
  <br><br>
  <textarea id="textarea" name="textarea" class="textarea" rows="20"></textarea><br>
  <input type="button" id="copy" value="コピー"><br>
  <div id="logs"></div>
  </form>
  <br><br>
  <a href="https://github.com/tutinoko2048/mcstructure-editor">github</a>
  
  <script>
  var textarea = document.getElementById('textarea');
  var copy = document.getElementById('copy');

  $(function() {
    $('#file').change(function(e) {
      var file = e.target.files[0];
      var reader = new FileReader();
      reader.onload = function() {
        var data = reader.result
        nbt.parse(data, function(error, data) {
          if (error) {
            throw error;
          }
          var textVal = JSON.stringify(data, null, 2);
          document.getElementById('textarea').value = textVal;
        });
      }

      reader.readAsArrayBuffer(file);
    });
  });

  copy.addEventListener('click', function () {
    var copyText = document.getElementsByTagName("textarea")[0];
    textarea.readOnly = true;
    copyText.select();
    textarea.readOnly = false;
    document.execCommand("copy");
    window.getSelection().removeAllRanges();
    alert('コピーしました');
  }

  </script>
</body>

</html>
